
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This contains all material for Markdown version of BTP workshops.">
      
      
      
        <meta name="author" content="Authors">
      
      
        <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.1">
    
    
      
        <title>Metagenomics Functional Analysis - Markdown Manuals for Bioinformatics Training Platform (BTP)</title>
      
    
    
      <script src="../../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application-f98ca285f9.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-8817cfa535.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../css/details.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../../.." title="Markdown Manuals for Bioinformatics Training Platform (BTP)" class="md-logo md-header-nav__button">
            <img src="../../../media/logos/bpalogo.png" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Metagenomics Modules
                </span>
              
            
            Metagenomics Functional Analysis
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../btp-module-chip-seq/chip-seq-draft-SL_ST/" title="BTP Modules" class="md-tabs__link">
          BTP Modules
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../cancer-module-alignment/alignment/" title="Cancer Genomics Modules" class="md-tabs__link">
          Cancer Genomics Modules
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../denovo-module-cli/commandline/" title="DeNovo Modules" class="md-tabs__link">
          DeNovo Modules
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../metagenomics-module-qc/ngs-qc/" title="Metagenomics Modules" class="md-tabs__link md-tabs__link--active">
          Metagenomics Modules
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../../media/logos/bpalogo.png">
      </i>
    
    Markdown Manuals for Bioinformatics Training Platform (BTP)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../timetables/timetable_cancer/" title="Timetable" class="md-nav__link">
      Timetable
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../preamble/" title="Workshop Information" class="md-nav__link">
      Workshop Information
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      BTP Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        BTP Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-chip-seq/chip-seq-draft-SL_ST/" title="ChIP-seq" class="md-nav__link">
      ChIP-seq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-denovo-canu/denovo_canu/" title="DeNovo Canu" class="md-nav__link">
      DeNovo Canu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-ngs-cli/commandline/" title="Introduction to Command Line" class="md-nav__link">
      Introduction to Command Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-ngs-qc/ngs-qc/" title="Data Quality" class="md-nav__link">
      Data Quality
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-ngs-mapping/alignment/" title="Read Alignment" class="md-nav__link">
      Read Alignment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-rna-seq/rna-seq/" title="RNA-Seq" class="md-nav__link">
      RNA-Seq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-velvet/velvet/" title="de novo Genome Assembly" class="md-nav__link">
      de novo Genome Assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-ngs-bio/biol/" title="NGS Biological Insight" class="md-nav__link">
      NGS Biological Insight
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Cancer Genomics Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Cancer Genomics Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-alignment/alignment/" title="Read Alignment" class="md-nav__link">
      Read Alignment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-snv/snv/" title="Single Nucleotide Variant Calling and Annotation" class="md-nav__link">
      Single Nucleotide Variant Calling and Annotation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-cnv/cnv-tut/" title="Copy Number Variation" class="md-nav__link">
      Copy Number Variation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-sv/sv_tut/" title="Structural Variant Analysis" class="md-nav__link">
      Structural Variant Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-viz/visu/" title="Variant Visualisation" class="md-nav__link">
      Variant Visualisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-6" type="checkbox" id="nav-5-6">
    
    <label class="md-nav__link" for="nav-5-6">
      Somatic Mutations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-6">
        Somatic Mutations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-somatic/01_signatures/" title="Assessing somatic mutational signatures" class="md-nav__link">
      Assessing somatic mutational signatures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-somatic/02_intogen/" title="Cohort analysis for the identification of driver genes" class="md-nav__link">
      Cohort analysis for the identification of driver genes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      DeNovo Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        DeNovo Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../denovo-module-cli/commandline/" title="DeNovo Command Line" class="md-nav__link">
      DeNovo Command Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../denovo-module-bac/bac_asm/" title="Bacterial Assembly" class="md-nav__link">
      Bacterial Assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../denovo-module-euk/eukaryotic_assem/" title="Eukaryote Assembly" class="md-nav__link">
      Eukaryote Assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../denovo-module-scaffolding/scaffold/" title="Scaffolding" class="md-nav__link">
      Scaffolding
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Metagenomics Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Metagenomics Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../metagenomics-module-qc/ngs-qc/" title="Metagenomics QC" class="md-nav__link">
      Metagenomics QC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../metagenomics-module-tax/tax/" title="Metagenomics Taxonomic" class="md-nav__link">
      Metagenomics Taxonomic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../metagenomics-module-vis/vis/" title="Metagenomics Visualisation" class="md-nav__link">
      Metagenomics Visualisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../metagenomics-module-wga/wga/" title="Metagenomics WGA" class="md-nav__link">
      Metagenomics WGA
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Metagenomics Functional Analysis
      </label>
    
    <a href="./" title="Metagenomics Functional Analysis" class="md-nav__link md-nav__link--active">
      Metagenomics Functional Analysis
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-learning-outcomes" title="Key Learning Outcomes" class="md-nav__link">
    Key Learning Outcomes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources-youll-be-using" title="Resources You’ll be Using" class="md-nav__link">
    Resources You’ll be Using
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools-used" title="Tools Used" class="md-nav__link">
    Tools Used
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#useful-links" title="Useful Links" class="md-nav__link">
    Useful Links
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-protein-signatures" title="What are protein signatures?" class="md-nav__link">
    What are protein signatures?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figures" title="Figures" class="md-nav__link">
    Figures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assigning-functional-information-to-metagenomic-sequences" title="Assigning functional information to metagenomic sequences" class="md-nav__link">
    Assigning functional information to metagenomic sequences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-functional-information-about-samples-on-the-emg-website" title="Finding functional information about samples on the EMG website" class="md-nav__link">
    Finding functional information about samples on the EMG website
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical" title="Practical" class="md-nav__link">
    Practical
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#part-1-browsing-analysed-data-via-the-emg-website" title="Part 1 – Browsing analysed data via the EMG website" class="md-nav__link">
    Part 1 – Browsing analysed data via the EMG website
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#part-2-analysing-emg-data-using-stamp" title="Part 2 - Analysing EMG data using STAMP" class="md-nav__link">
    Part 2 - Analysing EMG data using STAMP
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-learning-outcomes" title="Key Learning Outcomes" class="md-nav__link">
    Key Learning Outcomes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources-youll-be-using" title="Resources You’ll be Using" class="md-nav__link">
    Resources You’ll be Using
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools-used" title="Tools Used" class="md-nav__link">
    Tools Used
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#useful-links" title="Useful Links" class="md-nav__link">
    Useful Links
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-protein-signatures" title="What are protein signatures?" class="md-nav__link">
    What are protein signatures?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figures" title="Figures" class="md-nav__link">
    Figures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assigning-functional-information-to-metagenomic-sequences" title="Assigning functional information to metagenomic sequences" class="md-nav__link">
    Assigning functional information to metagenomic sequences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-functional-information-about-samples-on-the-emg-website" title="Finding functional information about samples on the EMG website" class="md-nav__link">
    Finding functional information about samples on the EMG website
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical" title="Practical" class="md-nav__link">
    Practical
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#part-1-browsing-analysed-data-via-the-emg-website" title="Part 1 – Browsing analysed data via the EMG website" class="md-nav__link">
    Part 1 – Browsing analysed data via the EMG website
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#part-2-analysing-emg-data-using-stamp" title="Part 2 - Analysing EMG data using STAMP" class="md-nav__link">
    Part 2 - Analysing EMG data using STAMP
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="functional-data-analysis">Functional Data Analysis<a class="headerlink" href="#functional-data-analysis" title="Permanent link">&para;</a></h1>
<h2 id="key-learning-outcomes">Key Learning Outcomes<a class="headerlink" href="#key-learning-outcomes" title="Permanent link">&para;</a></h2>
<hr />
<p>After completing this module the trainee should be able to:</p>
<ul>
<li>
<p>Understand how EMG provides functional analysis of metagenomic data sets</p>
</li>
<li>
<p>Know where to find and how to interpret analysis results for samples on the EMG website</p>
</li>
<li>
<p>Know how to download the raw sample data and analysis results for use with 3<sup>rd</sup> party visualisation and statistical analysis packages</p>
</li>
</ul>
<h2 id="resources-youll-be-using">Resources You’ll be Using<a class="headerlink" href="#resources-youll-be-using" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="tools-used">Tools Used<a class="headerlink" href="#tools-used" title="Permanent link">&para;</a></h3>
<p>STAMP :<br />
<a href="http://kiwi.cs.dal.ca/Software/STAMP">http://kiwi.cs.dal.ca/Software/STAMP</a></p>
<h3 id="useful-links">Useful Links<a class="headerlink" href="#useful-links" title="Permanent link">&para;</a></h3>
<hr />
<p>EBI Metagenomics resource (EMG) : <br />
<a href="../www.ebi.ac.uk/metagenomics/"><a href="http://www.ebi.ac.uk/metagenomics/">www.ebi.ac.uk/metagenomics/</a></a></p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<hr />
<p>The EBI Metagenomics resource (EMG) provides functional analysis of
predicted coding sequences (pCDS) from metagenomic data sets using the
InterPro database. InterPro is a sequence analysis resource that
predicts protein family membership, along with the presence of important
domains and sites. It does this by combining predictive models known as
protein signatures from a number of different databases into a single
searchable resource. InterPro curators manually integrate the different
signatures, providing names and descriptive abstracts and, whenever
possible, adding Gene Ontology (GO) terms. Links are also provided to
pathway databases, such as KEGG, MetaCyc and Reactome, and to structural
resources, such as SCOP, CATH and PDB.</p>
<h3 id="what-are-protein-signatures">What are protein signatures?<a class="headerlink" href="#what-are-protein-signatures" title="Permanent link">&para;</a></h3>
<p>Protein signatures are obtained by modelling the conservation of amino
acids at specific positions within a group of related proteins (i.e., a
protein family), or within the domains/sites shared by a group of
proteins. InterPro’s different member databases use different
computational methods to produce protein signatures, and they each have
their own particular focus of interest: structural and/or functional
domains, protein families, or protein features, such as active sites or
binding sites (see Figure 1).</p>
<h3 id="figures">Figures<a class="headerlink" href="#figures" title="Permanent link">&para;</a></h3>
<p><img alt="InterPro member databases grouped by the methods, indicated in white
coloured text, used to construct their signatures. Their focus of
interest is shown in blue
text." src="../images/InterPro.png" /></p>
<p>Only a subset of the InterPro member databases are used by EMG: Gene3D,
TIGRFAMs, Pfam, PRINTS and PROSITE patterns. These databases were
selected since, together, they provide both high coverage and offer
detailed functional analysis, and have underlying algorithms that can
cope with the vast amounts of fragmentary sequence data found in
metagenomic datasets.</p>
<h3 id="assigning-functional-information-to-metagenomic-sequences">Assigning functional information to metagenomic sequences<a class="headerlink" href="#assigning-functional-information-to-metagenomic-sequences" title="Permanent link">&para;</a></h3>
<p>Whilst InterPro matches to metagenomic sequence sets are informative in
their own right, EMG offers an additional type of analysis in the form
of Gene Ontology (GO) terms. The Gene Ontology is made up of 3
structured controlled vocabularies that describe gene products in terms
of their associated biological processes, cellular components and
molecular functions in a species-independent manner. By using GO terms,
scientists working on different species or using different databases can
compare datasets, since they have a precisely defined name and meaning
for a particular concept. Terms in the Gene Ontology are ordered into
hierarchies, with less specific terms towards the top and more specific
terms towards the bottom (see Figure 2).</p>
<p>An example of GO terms organised into a hierarchy, with terms becoming less specific as the hierarchy is ascended (e.g., alpha-tubulin binding
is a type of cytoskeletal binding, which is a type of protein binding).
Note that a GO term can have more than one parent term. The Gene
Ontology also allows for different types of relationships between terms
(such as ‘has part of’ or ‘regulates’). The EMG analysis pipeline only
uses the straightforward ‘is a’
relationships.</p>
<p><img alt="GO" src="../images/GO.png" /></p>
<p>More information about the GO project can be found
<a href="http://www.geneontology.org/GO.doc.shtml">http://www.geneontology.org/GO.doc.shtml</a></p>
<p>As part of the EMG analysis pipeline, GO terms for molecular function,
biological process and cellular component are associated to pCDS in a
sample via the InterPro2GO mapping service. This works as follows:
InterPro entries are given GO terms by curators if the terms can be
accurately applied to all of the proteins matching that entry. Sequences
searched against InterPro are then associated with GO terms by virtue of
the entries they match - a protein that matches one InterPro entry with
the GO term ‘kinase activity’ and another InterPro entry with the GO
term ‘zinc ion binding’ will be annotated with both GO terms.</p>
<h3 id="finding-functional-information-about-samples-on-the-emg-website">Finding functional information about samples on the EMG website<a class="headerlink" href="#finding-functional-information-about-samples-on-the-emg-website" title="Permanent link">&para;</a></h3>
<p>Functional analysis of samples within projects on the EMG website
<a href="../www.ebi.ac.uk/metagenomics/"><a href="http://www.ebi.ac.uk/metagenomics/">www.ebi.ac.uk/metagenomics/</a></a> can be
accessed by clicking on the Functional Analysis tab found toward the top
of any sample page (see Figure 3 below).</p>
<p>A Functional analysis tab can be found towards the top of each sample .page</p>
<p><img alt="FA" src="../images/FA.png" /></p>
<p>Clicking on this tab brings up a page displaying sequence features (the
number of reads with pCDS, the number of pCDS with InterPro matches,
etc), InterPro match information and GO term annotation for the sample,
as shown in Figure 4 and 5 below.</p>
<p>Functional analysis of metagenomics data, as shown on the EMG website.</p>
<p>InterPro match information for the predicted coding sequences in the sample is shown. The number of InterPro matches are displayed graphically, and as a table that has a text search facility.</p>
<p><img alt="FA_Iterpro" src="../images/FA_Interpro.png" /></p>
<p>The GO terms predicted for the sample are displayed. Different
graphical representations are available, and can be selected by clicking
on the ‘Switch view’
icons.</p>
<p><img alt="FA_GO" src="../images/FA_GO.png" /></p>
<p>The Gene Ontology terms displayed graphically on the web site have been
‘slimmed’ with a special GO slim developed for metagenomic data sets. GO
slims are cut-down versions of the Gene Ontology, containing a subset of
the terms in the whole GO. They give a broad overview of the ontology
content without the detail of the specific fine-grained terms.</p>
<p>The full data sets used to generate both the InterPro and GO overview
charts, along with a host of additional data (processed reads, pCDS,
reads encoding 16S rRNAs, taxonomic analyses, etc) can be downloaded for
further analysis by clicking the Download tab, found towards the top of
the page (see Figure 6).</p>
<p>Each sample has a download tab, where the full set of sequences,
analyses, summaries and raw data can be
downloaded.</p>
<p><img alt="FA_DL" src="../images/FA_DL.png" /></p>
<h2 id="practical">Practical<a class="headerlink" href="#practical" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="part-1-browsing-analysed-data-via-the-emg-website">Part 1 – Browsing analysed data via the EMG website<a class="headerlink" href="#part-1-browsing-analysed-data-via-the-emg-website" title="Permanent link">&para;</a></h3>
<p>Open the Metagenomics Portal homepage in a web browser
<a href="https://www.ebi.ac.uk/metagenomics/">https://www.ebi.ac.uk/metagenomics/</a>.</p>
<p>From the Projects list click the ‘Projects’ tab, or ‘View all projects’,
find and click on HOT station, Central North Pacific Gyre, ALOH. You
should now have a Project overview page describing the project, related
publications, and links to the samples that the project contains.</p>
<p>Question 1: What publications are associated with this study?</p>
<p>Scroll down to Associated Samples and open the HOT Station ALOHA, 25 m
sample. You should now have a Sample Overview page, describing various
meta-data associated with the sample, such as the geographic location
from which it was isolated, its collection date, and so on.</p>
<p>Question 2: What is the latitude, longitude and depth at which the
sample was collected?</p>
<p>Question 3: What geographic location does this correspond to?</p>
<p>Question 4: What environmental ontology (ENVO) identifer and name has
the sample material been annotated with?</p>
<p>Click on the ‘Download’ tab. Right click the file labelled ‘Predicted
CDS (FASTA)’ link, and save this file to your desktop. Find the file,
and either double click on it to open it, or examine it using ‘less’ by
typing the following commands in a terminal window:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>cd ~/Desktop
less HOT_Station_ALOHA,_25m_depth_pCDS.faa
</pre></div>
</td></tr></table>

<p>Have a look at one or two of the many sequences it contains. We will
look at the analysis results for this entire batch of sequences,
displayed on the EMG website, in a moment. First, we will attempt
analyse just one of the predicted coding sequences using InterPro (the
analysis results on the EMG website summarise these kind of results for
tens or hundreds of thousands of sequences).</p>
<p>In a new tab or window, open your web browser and navigate to
<a href="http://www.ebi.ac.uk/interpro/">http://www.ebi.ac.uk/interpro/</a>. Copy and paste the following sequence
into the text box on the InterPro home page where it says ‘Analyse your
sequence’:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>&gt;SRR010898.122503_1_115_+
ENNQEIKIIRNYINEFNLTGFIVGIPLDEKGQMTNQAI
</pre></div>
</td></tr></table>

<p>Press Search and wait for your results. Your sequence will be run
through the InterProScan analysis software, which attempts to match it
against all of the different signatures in the InterProScan database.</p>
<p>Question 5: What feature does InterProScan predict your sequence to
contain?</p>
<p>Clicking on the InterPro entry name or IPR accession number will take
you to the InterPro entry page for your result, where more information
can be found.</p>
<p>Question 6: What GO terms is the feature associated with?</p>
<p>Return to the sample page for HOT station, Central North Pacific Gyre,
ALOH 25 m.</p>
<p>Now we are going to look at the functional analysis results for all of
the pCDS in the sample. First, we will find the number of sequences that
made it through to the functional analysis section of the pipeline.</p>
<p>Click on the Quality control tab. This page displays a series of charts,
showing how many sequences passed each quality control step, how many
reads were left after clustering, and so on.</p>
<p>Question 7: After all of the quality filtering steps are complete, how
many reads were submitted for analysis by the pipeline?</p>
<p>Next, we will look at the results of the functional predictions for the
pCDS. These can be found under the Functional analysis tab.</p>
<p>Click on the Functional analysis tab and examine the InterPro match
section. The top part of this page shows a sequence feature summary,
showing the number of reads with predicted coding sequences (pCDS), the
number of pCDS with InterPro matches, etc.</p>
<p>Question 8: How many of the reads that passed the quality control stage
had predicted coding sequences (pCDS)?</p>
<p>Question 9: How many pCDS have InterProScan hits?</p>
<p>Scroll down the page to the InterPro match summary section</p>
<p>Question 10: How many different InterPro entries were matched by the
pCDS?</p>
<p>Question 11: Why is this figure different to the number of pCDS that
have InterProScan hits?</p>
<p>Next we will examine the GO terms predicted by InterPro for the pCDS in
the sample.</p>
<p>Scroll down to the GO term annotation section of the page and examine
the 3 bar charts, which correspond to the 3 different components of the
Gene Ontology.</p>
<p>Question 12: What are the top 3 biological process terms predicted for
the pCDS from the sample?</p>
<p>Selecting the pie chart representation of GO terms makes it easier to
visualise the data to find the answer.</p>
<p>Now we will look at the taxonomic analysis for this sample.</p>
<p>Click on the Taxonomy Analysis tab and examine the phylum composition
graph and table.</p>
<p>Question 13: How many different OTUs were found in this sample?</p>
<p>Question 14: What are the top 3 phyla in the sample?</p>
<p>Select the Krona chart view of the data icon. This brings up an
interactive chart that can be used to analyse data at different
taxonomic ranks.</p>
<p>Question 15: What proportion of cyanobacteria in this sample are made up
of Synechococcaceae?</p>
<p>Now we will compare these analyses with those for a sample taken at 500
m from the same geographical location.</p>
<p>In a new tab or window, find and open the HOT station, Central North
Pacific Gyre, ALOH project page again. Select the sample HOT Station
ALOHA, 500m and examine the information under the Functional analysis
tabs. Question 16: How many pCDS were in this sample? Question 17: How
many of the pCDSs have an InterPro match? Question 18: How many
different InterPro entries are matched by this sample? Question 19: Are
these figures broadly comparable to the ones for the 25 m sample?</p>
<p>Scroll to the bottom of the page and examine the GO term annotation for
the day 500 m sample.</p>
<p>Question 20: Are there visible differences between the GO terms for this
sample and the 25 m sample? Could there be any biological explanation
for this?</p>
<p>Selecting the bar chart representation of GO terms makes it easier to
compare different data sets.</p>
<p>Return to the HOT station project page and open the taxonomy analysis
results for all 4 of the samples, each in a new window.</p>
<p>Question 21: How does the taxonomic composition change at different
ocean sampling depths? Are any trends in the data consistent with your
answer to question 18?</p>
<h3 id="part-2-analysing-emg-data-using-stamp">Part 2 - Analysing EMG data using STAMP<a class="headerlink" href="#part-2-analysing-emg-data-using-stamp" title="Permanent link">&para;</a></h3>
<p>Whilst EMG does not currently support direct comparison of multiple
samples, it is possible to download the underlying data for use with
other visualisation and/or statistical analysis tools, such as STAMP
(Statistical Analysis of Metagenomic Profiles:
<a href="http://kiwi.cs.dal.ca/Software/STAMP">http://kiwi.cs.dal.ca/Software/STAMP</a>. The Downloads tab for a given
sample lists the files with the necessary data, although a slight amount
of data wrangling is usually required to reformat files, etc.</p>
<p>We are going perform a detailed comparison of the GO slimmed biological
process results for the samples at 25 m and 500 m using STAMP. To do
this, open the HOT station, Central North Pacific Gyre, ALOH project
page again. Select the sample HOT Station ALOHA, 25 m study and download
the GO slim annotation (CSV) file from the download tab. Repeat this for
the HOT Station ALOHA, 500 m study.</p>
<p>You should now have the following 2 files in your downloads folder:
HOT_Station_ALOHA,_25m_depth_GO_slim.csv
HOT_Station_ALOHA,_500m_depth,_MG_GO_slim.csv.txt (don’t worry
about the fact the file names are constructed slightly differently –
this is an inconsistency on our web site that needs to be corrected!)</p>
<p>Drag or copy these files to your desktop, and then launch a terminal
window, so that you can manipulate the files on the command line.</p>
<p>Navigate to the Desktop directory by typing ‘cd ~/Desktop/’ Next, type
‘ls’ to make sure you can see the files, and take a look at their
contents using the ‘less’ command.</p>
<p>First we are going to wrangle data from the 25 m sample, using a mixture
of ‘grep’ to pull out the lines containing the phrase
‘biological_process’ and ‘awk’ to split up and reorder the fields.</p>
<p>awk is a text-processing language that is useful for extracting or
transforming documents and reformatting text. You can find out more
about it here: <a href="http://www.gnu.org/software/gawk/manual/gawk.html">http://www.gnu.org/software/gawk/manual/gawk.html</a></p>
<p>Enter the following command (all on one line):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>grep &#39;biological_process&#39;  HOT_Station_ALOHA,_25m_depth_GO_slim.csv  | awk -F&quot; &#39;{print \$6 &quot;\t&quot; \$4 &quot;\t&quot; \$8 }&#39;  &gt;  biological_process_25m.txt
</pre></div>
</td></tr></table>

<p>This should produce a new file called ‘biological_process_26m.txt’.
Use ‘less’ to examine this file.</p>
<p>Question 22: What are the differences between this file and the
HOT_Station_ALOHA,_25m_depth_GO_slim.csv file?</p>
<p>Next, we are going to add the biological process data from the 500 m
sample to this file. Once again, will use ‘grep’ to pull out the
relevant lines in the source file, ‘awk’ to process the lines and output
the correct fields, and ‘paste’ to merge the data with the contents of
the file we produced above.</p>
<p>Enter the following command (all on one line):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>grep &#39;biological_process&#39; HOT_Station_ALOHA,_500m_depth,_MG_GO_slim.csv | awk -F&quot;{}&quot; &#39;{print \$8 }&#39; | paste biological_process_25m.txt - &gt; biological_process_25mvs500m.txt
</pre></div>
</td></tr></table>

<p>This should create another new file, this time called
‘biological_process_25mvs500m.txt’. Use ‘less’ to examine this file.</p>
<p>Question 23: What is the difference between this file and the
biological_process_25m.txt file?</p>
<p>Finally, we need to add a simple header to the file, so that STAMP can
process it properly. To do this, we could open the file and add the
header manually, but here we will do it on the command line using the
‘printf’ command to write the header, ‘cat’ to print the contents of the
file, and directing the output to a new file with the ‘&gt;’ operator.</p>
<p>Enter the following command (all on one line):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>printf &quot;Classification\tSubclassification\t25m\t500m\n&quot; | cat - biological_process_25mvs500m.txt &gt; biological_process_25mvs500m.spf
</pre></div>
</td></tr></table>

<p>This command should have produced a third file called
‘biological_process_25mvs500m.spf’ that STAMP can read.</p>
<p>To launch STAMP, type STAMP in the terminal, hit the enter/return key, a
graphical interface will then appear. Load the
biological_process_25mvs500m.spf file into STAMP (you will need to set
‘Profile level’ to ‘Subclassification’ and select ‘Two samples’ from the
tabs on the left hand side of the page to view the file once it is
loaded). Try experimenting with different plot types and statistical
tests.</p>
<p>Question 24: Are there any observable differences in biological process
GO terms between the 2 samples?</p>
<p>For your convenience, three files containing the HOT Station GO term
results for all 3 branches of the Gene Ontology (molecular function,
biological process and cellular component) at each sample depth, and a
corresponding metadata file have been pre-generated and formatted for
use with STAMP.</p>
<p>These are located in the /Desktop/InterproTutorial/
folder on the desktop (filenames: HOT_Station_ALOHA_bp.spf,
HOT_Station_ALOHA_mf.spf, HOT_Station_ALOHA_cc.spf and
HOT_Station_ALOHA_metadata.tsv).</p>
<p>Try loading these files into STAMP, as you did with the previous file,
and exploring the results. You can select different samples to compare
(25, 75, 125 and 500 m) using the sample 1 and sample 2 drop down menus.
You can now also use the Multiple Groups tab and explore some of its
options.</p>
<p>Question 25: What trends can you identify in the molecular function,
biological process and cellular component GO terms across the different
sampling depths?</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../metagenomics-module-wga/wga/" title="Metagenomics WGA" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Metagenomics WGA
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; The authors; 2017-
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application-e3caa82af6.js"></script>
      
      
      <script>app.initialize({url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../../../js/details.js"></script>
      
    
    
      
    
  </body>
</html>