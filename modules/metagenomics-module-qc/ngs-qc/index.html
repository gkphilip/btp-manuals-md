
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This contains all material for Markdown version of BTP workshops.">
      
      
      
        <meta name="author" content="Authors">
      
      
        <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.1">
    
    
      
        <title>Metagenomics QC - Markdown Manuals for Bioinformatics Training Platform (BTP)</title>
      
    
    
      <script src="../../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application-f98ca285f9.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-8817cfa535.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../css/details.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../../.." title="Markdown Manuals for Bioinformatics Training Platform (BTP)" class="md-logo md-header-nav__button">
            <img src="../../../media/logos/bpalogo.png" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Metagenomics Modules
                </span>
              
            
            Metagenomics QC
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../btp-module-chip-seq/chip-seq-draft-SL_ST/" title="BTP Modules" class="md-tabs__link">
          BTP Modules
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../cancer-module-alignment/alignment/" title="Cancer Genomics Modules" class="md-tabs__link">
          Cancer Genomics Modules
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../denovo-module-cli/commandline/" title="DeNovo Modules" class="md-tabs__link">
          DeNovo Modules
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="./" title="Metagenomics Modules" class="md-tabs__link md-tabs__link--active">
          Metagenomics Modules
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../../media/logos/bpalogo.png">
      </i>
    
    Markdown Manuals for Bioinformatics Training Platform (BTP)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../timetables/timetable_cancer/" title="Timetable" class="md-nav__link">
      Timetable
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../preamble/" title="Workshop Information" class="md-nav__link">
      Workshop Information
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      BTP Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        BTP Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-chip-seq/chip-seq-draft-SL_ST/" title="ChIP-seq" class="md-nav__link">
      ChIP-seq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-denovo-canu/denovo_canu/" title="DeNovo Canu" class="md-nav__link">
      DeNovo Canu
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-ngs-cli/commandline/" title="Introduction to Command Line" class="md-nav__link">
      Introduction to Command Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-ngs-qc/ngs-qc/" title="Data Quality" class="md-nav__link">
      Data Quality
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-ngs-mapping/alignment/" title="Read Alignment" class="md-nav__link">
      Read Alignment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-rna-seq/rna-seq/" title="RNA-Seq" class="md-nav__link">
      RNA-Seq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-velvet/velvet/" title="de novo Genome Assembly" class="md-nav__link">
      de novo Genome Assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../btp-module-ngs-bio/biol/" title="NGS Biological Insight" class="md-nav__link">
      NGS Biological Insight
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Cancer Genomics Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Cancer Genomics Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-alignment/alignment/" title="Read Alignment" class="md-nav__link">
      Read Alignment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-snv/snv/" title="Single Nucleotide Variant Calling and Annotation" class="md-nav__link">
      Single Nucleotide Variant Calling and Annotation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-cnv/cnv-tut/" title="Copy Number Variation" class="md-nav__link">
      Copy Number Variation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-sv/sv_tut/" title="Structural Variant Analysis" class="md-nav__link">
      Structural Variant Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-viz/visu/" title="Variant Visualisation" class="md-nav__link">
      Variant Visualisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-6" type="checkbox" id="nav-5-6">
    
    <label class="md-nav__link" for="nav-5-6">
      Somatic Mutations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-6">
        Somatic Mutations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-somatic/01_signatures/" title="Assessing somatic mutational signatures" class="md-nav__link">
      Assessing somatic mutational signatures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cancer-module-somatic/02_intogen/" title="Cohort analysis for the identification of driver genes" class="md-nav__link">
      Cohort analysis for the identification of driver genes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      DeNovo Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        DeNovo Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../denovo-module-cli/commandline/" title="DeNovo Command Line" class="md-nav__link">
      DeNovo Command Line
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../denovo-module-bac/bac_asm/" title="Bacterial Assembly" class="md-nav__link">
      Bacterial Assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../denovo-module-euk/eukaryotic_assem/" title="Eukaryote Assembly" class="md-nav__link">
      Eukaryote Assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../denovo-module-scaffolding/scaffold/" title="Scaffolding" class="md-nav__link">
      Scaffolding
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Metagenomics Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Metagenomics Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Metagenomics QC
      </label>
    
    <a href="./" title="Metagenomics QC" class="md-nav__link md-nav__link--active">
      Metagenomics QC
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-learning-outcomes" title="Key Learning Outcomes" class="md-nav__link">
    Key Learning Outcomes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources-youll-be-using" title="Resources You’ll be Using" class="md-nav__link">
    Resources You’ll be Using
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools-used" title="Tools Used" class="md-nav__link">
    Tools Used
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-links" title="Useful Links" class="md-nav__link">
    Useful Links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quality-value-encoding-schema" title="Quality Value Encoding Schema" class="md-nav__link">
    Quality Value Encoding Schema
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-the-environment" title="Prepare the Environment" class="md-nav__link">
    Prepare the Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quality-visualisation" title="Quality Visualisation" class="md-nav__link">
    Quality Visualisation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#good-quality-data" title="Good Quality Data" class="md-nav__link">
    Good Quality Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-trimming" title="Read Trimming" class="md-nav__link">
    Read Trimming
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quality-based-trimming" title="Quality Based Trimming" class="md-nav__link">
    Quality Based Trimming
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adapter-clipping" title="Adapter Clipping" class="md-nav__link">
    Adapter Clipping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixed-length-trimming" title="Fixed Length Trimming" class="md-nav__link">
    Fixed Length Trimming
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-duplicates" title="Removing Duplicates" class="md-nav__link">
    Removing Duplicates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../metagenomics-module-tax/tax/" title="Metagenomics Taxonomic" class="md-nav__link">
      Metagenomics Taxonomic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../metagenomics-module-vis/vis/" title="Metagenomics Visualisation" class="md-nav__link">
      Metagenomics Visualisation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../metagenomics-module-wga/wga/" title="Metagenomics WGA" class="md-nav__link">
      Metagenomics WGA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../metagenomics-module-fda/fda/" title="Metagenomics Functional Analysis" class="md-nav__link">
      Metagenomics Functional Analysis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-learning-outcomes" title="Key Learning Outcomes" class="md-nav__link">
    Key Learning Outcomes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources-youll-be-using" title="Resources You’ll be Using" class="md-nav__link">
    Resources You’ll be Using
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools-used" title="Tools Used" class="md-nav__link">
    Tools Used
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-links" title="Useful Links" class="md-nav__link">
    Useful Links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quality-value-encoding-schema" title="Quality Value Encoding Schema" class="md-nav__link">
    Quality Value Encoding Schema
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-the-environment" title="Prepare the Environment" class="md-nav__link">
    Prepare the Environment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quality-visualisation" title="Quality Visualisation" class="md-nav__link">
    Quality Visualisation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#good-quality-data" title="Good Quality Data" class="md-nav__link">
    Good Quality Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-trimming" title="Read Trimming" class="md-nav__link">
    Read Trimming
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quality-based-trimming" title="Quality Based Trimming" class="md-nav__link">
    Quality Based Trimming
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adapter-clipping" title="Adapter Clipping" class="md-nav__link">
    Adapter Clipping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixed-length-trimming" title="Fixed Length Trimming" class="md-nav__link">
    Fixed Length Trimming
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-duplicates" title="Removing Duplicates" class="md-nav__link">
    Removing Duplicates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="data-quality-control">Data Quality Control<a class="headerlink" href="#data-quality-control" title="Permanent link">&para;</a></h1>
<h2 id="key-learning-outcomes">Key Learning Outcomes<a class="headerlink" href="#key-learning-outcomes" title="Permanent link">&para;</a></h2>
<hr />
<p>After completing this practical the trainee should be able to:</p>
<ul>
<li>
<p>Assess the overall quality of NGS (FastQ format) sequence reads</p>
</li>
<li>
<p>Visualise the quality, and other associated matrices, of reads to decide on filters and cutoffs for cleaning up data ready for downstream analysis</p>
</li>
<li>
<p>Clean up adaptors and pre-process the sequence data for further analysis</p>
</li>
</ul>
<h2 id="resources-youll-be-using">Resources You’ll be Using<a class="headerlink" href="#resources-youll-be-using" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="tools-used">Tools Used<a class="headerlink" href="#tools-used" title="Permanent link">&para;</a></h3>
<p>FastQC:<br />
<a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">http://www.bioinformatics.babraham.ac.uk/projects/fastqc/</a></p>
<p>Skewer:<br />
<a href="http://sourceforge.net/projects/skewer/">http://sourceforge.net/projects/skewer/</a></p>
<p>FASTX-Toolkit:<br />
<a href="http://hannonlab.cshl.edu/fastx_toolkit/">http://hannonlab.cshl.edu/fastx_toolkit/</a>&gt;</p>
<p>Picard:<br />
<a href="http://picard.sourceforge.net/">http://picard.sourceforge.net/</a></p>
<h2 id="useful-links">Useful Links<a class="headerlink" href="#useful-links" title="Permanent link">&para;</a></h2>
<hr />
<p>FASTQ Encoding:<br />
<a href="http://en.wikipedia.org/wiki/FASTQ_format#Encoding">http://en.wikipedia.org/wiki/FASTQ_format#Encoding</a></p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<hr />
<p>Going on a blind date with your read set? For a better understanding of
the consequences please check the data quality!</p>
<p>For the purpose of this tutorial we are focusing only on Illumina
sequencing which uses ’sequence by synthesis’ technology in a highly
parallel fashion. Although Illumina high throughput sequencing provides
highly accurate sequence data, several sequence artifacts, including
base calling errors and small insertions/deletions, poor quality reads
and primer/adapter contamination are quite common in the high throughput
sequencing data. The primary errors are substitution errors. The error
rates can vary from 0.5-2.0% with errors mainly rising in frequency at
the 3’ ends of reads.</p>
<p>One way to investigate sequence data quality is to visualize the quality
scores and other metrics in a compact manner to get an idea about the
quality of a read data set. Read data sets can be improved by pre
processing in different ways like trimming off low quality bases,
cleaning up any sequencing adapters, removing PCR duplicates and
screening for contamination. We can also look at other statistics such
as, sequence length distribution, base composition, sequence complexity,
presence of ambiguous bases etc. to assess the overall quality of the
data set.</p>
<p>Highly redundant coverage (&gt;15X) of the genome can be used to correct
sequencing errors in the reads before assembly. Various k-mer based
error correction methods exist but are beyond the scope of this
tutorial.</p>
<h3 id="quality-value-encoding-schema">Quality Value Encoding Schema<a class="headerlink" href="#quality-value-encoding-schema" title="Permanent link">&para;</a></h3>
<p>In order to use a single character to encode Phred qualities, ASCII
characters are used
(<a href="http://shop.alterlinks.com/ascii-table/ascii-table-us.php">http://shop.alterlinks.com/ascii-table/ascii-table-us.php</a>). All ASCII
characters have a decimal number associated with them but the first 32
characters are non-printable (e.g. backspace, shift, return, escape).
Therefore, the first printable ASCII character is number 33, the
exclamation mark (!). In Phred+33 encoded quality values the exclamation
mark takes the Phred quality score of zero.</p>
<p>Early Solexa (now Illumina) sequencing needed to encode negative quality
values. Because ASCII characters $&lt;$ 33 are non-printable, using the
Phred+33 encoding was not possible. Therefore, they simply moved the
offset from 33 to 64 thus inventing the Phred+64 encoded quality values.
In this encoding a Phred quality of zero is denoted by the ASCII number
64 (the @ character). Since Illumina 1.8, quality values are now encoded
using Phred+33.</p>
<p>FASTQ does not provide a way to describe what quality encoding is used
for the quality values. Therefore, you should find this out from your
sequencing provider. Alternatively, you may be able to figure this out
by determining what ASCII characters are present in the FASTQ file. E.g
the presence of numbers in the quality strings, can only mean the
quality values are Phred+33 encoded. However, due to the overlapping
nature of the Phred+33 and Phred+64 encoding schema it is not always
possible to identify what encoding is in use. For example, if the only
characters seen in the quality string are (<code class="codehilite">@ABCDEFGHI</code>), then it is
impossible to know if you have really good Phred+33 encoded qualities or
really bad Phred+64 encoded qualities.</p>
<p>For a graphical representation of the different ASCII characters used in
the two encoding schema see:
<a href="http://en.wikipedia.org/wiki/FASTQ_format#Encoding">http://en.wikipedia.org/wiki/FASTQ_format#Encoding</a></p>
<h2 id="prepare-the-environment">Prepare the Environment<a class="headerlink" href="#prepare-the-environment" title="Permanent link">&para;</a></h2>
<hr />
<p>To investigate sequence data quality we will demonstrate tools called
FastQC and Skewer. FastQC will process and present the reports in a
visual manner. Based on the results, the sequence data can be processed
using the Skewer. We will use one data set in this practical, which can
be found in the QC directory on your desktop.</p>
<p>Open the Terminal and go to the directory where the data are stored:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>ls
cd qc
pwd
</pre></div>
</td></tr></table>

<p>At any time, help can be displayed for FastQC using the following
command:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>fastqc -h
</pre></div>
</td></tr></table>

<p>Look at SYNOPSIS (Usage) and options after typing fastqc -h</p>
<h2 id="quality-visualisation">Quality Visualisation<a class="headerlink" href="#quality-visualisation" title="Permanent link">&para;</a></h2>
<hr />
<p>We have a file for a good quality and bad quality statistics. FastQC
generates results in the form of a zipped and unzipped directory for
each input file.</p>
<p>Execute the following command on the two files:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>fastqc -f qcdemo_R1.fastq.gz
fastqc -f qcdemo_R2.fastq.gz
</pre></div>
</td></tr></table>

<p>View the FastQC report file of the bad data using a web browser such as
firefox. The ’&amp;’ sign puts the job in the background.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>firefox qcdemo_R2_fastqc.html &amp;
</pre></div>
</td></tr></table>

<p>The report file will have a Basic Statistics table and various graphs
and tables for different quality statistics. E.g.:</p>
<table>
<thead>
<tr>
<th>Filename</th>
<th>qcdemo_R2.fastq.gz</th>
</tr>
</thead>
<tbody>
<tr>
<td>File type</td>
<td>Conventional base calls</td>
</tr>
<tr>
<td>Encoding</td>
<td>Sanger / Illumina 1.9</td>
</tr>
<tr>
<td>Total Sequences</td>
<td>1000000</td>
</tr>
<tr>
<td>Filtered Sequences</td>
<td>0</td>
</tr>
<tr>
<td>Sequence length</td>
<td>150</td>
</tr>
<tr>
<td>%GC</td>
<td>37</td>
</tr>
</tbody>
</table>
<p>FastQC Basic Statistics table</p>
<p><img alt="tab:badexampleuntrimmed" src="../images/bad_example.png" /></p>
<p>Per base sequence quality plot for
<code class="codehilite">qcdemo_R2.fastq.gz</code>.</p>
<p><img alt="Per base sequence quality plot for
qcdemo_R2.fastq.gz" src="../images/bad_qcdemo_R2.png" /></p>
<p>A Phred quality score (or Q-score) expresses an error probability. In
particular, it serves as a convenient and compact way to communicate
very small error probabilities. The probability that base <code class="codehilite">A</code> is wrong <code class="codehilite">P(sim A)</code> is expressed by a quality score, <code class="codehilite">Q(A)</code>, according to the
relationship:</p>
<p><code class="codehilite">Q(A) =-10 log10(P(sim A))</code></p>
<p>The relationship between the quality score and error probability is
demonstrated with the following table:</p>
<table>
<thead>
<tr>
<th>Quality score</th>
<th>Error probability</th>
<th>Accuracy of the base call</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>0.1</td>
<td>90%</td>
</tr>
<tr>
<td>20</td>
<td>0.01</td>
<td>99%</td>
</tr>
<tr>
<td>30</td>
<td>0.001</td>
<td>99.9%</td>
</tr>
<tr>
<td>40</td>
<td>0.0001</td>
<td>99.99%</td>
</tr>
<tr>
<td>50</td>
<td>0.00001</td>
<td>99.999%</td>
</tr>
</tbody>
</table>
<p>Error probabilities associated with various quality (Q) values</p>
<p>[tab:quality_error_probs]</p>
<p><img alt="Question" src="../images/questions.png" /></p>
<ol>
<li>How many sequences were there in your file? What is the read length?</li>
</ol>
<p>This is a spoiler: {%s%}Hello World.{%ends%}</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>&gt; 1,000,000. read length=150bp
</pre></div>
</td></tr></table>

<ol>
<li>
<p>Does the quality score values vary throughout the read length? (hint:
look at the ’per base sequence quality plot’)</p>
<blockquote>
<p>Yes. Quality scores are dropping towards the end of the reads.</p>
</blockquote>
</li>
<li>
<p>What is the quality score range you see?</p>
<blockquote>
<p>2-40</p>
</blockquote>
</li>
<li>
<p>At around which position do the scores start falling below Q20 for the 25% quartile range (25%of reads below Q20)?</p>
<blockquote>
<p>Around 30 bp position</p>
</blockquote>
</li>
<li>
<p>How can we trim the reads to filter out the low quality data?</p>
<blockquote>
<p>By trimming off the bases after a fixed position of the read or by trimming off bases based on the quality score.</p>
</blockquote>
</li>
</ol>
<h2 id="good-quality-data">Good Quality Data<a class="headerlink" href="#good-quality-data" title="Permanent link">&para;</a></h2>
<p>View the FastQC report files <code class="codehilite">fastqc_report.html</code> to see examples of a
good quality data and compare the quality plot with that of the
<code class="codehilite">bad_example_fastqc</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>firefox qcdemo_R1_fastqc.html &amp;
</pre></div>
</td></tr></table>

<p>Sequencing errors can complicate the downstream analysis, which normally
requires that reads be aligned to each other (for genome assembly) or to
a reference genome (for detection of mutations). Sequence reads
containing errors may lead to ambiguous paths in the assembly or
improper gaps. In variant analysis projects sequence reads are aligned
against the reference genome. The errors in the reads may lead to more
mismatches than expected from mutations alone. But if these errors can
be removed or corrected, the read alignments and hence the variant
detection will improve. The assemblies will also improve after
pre-processing the reads to remove errors.</p>
<h2 id="read-trimming">Read Trimming<a class="headerlink" href="#read-trimming" title="Permanent link">&para;</a></h2>
<hr />
<p>Read trimming can be done in a variety of different ways. Choose a
method which best suits your data. Here we are giving examples of
fixed-length trimming and quality-based trimming.</p>
<h3 id="quality-based-trimming">Quality Based Trimming<a class="headerlink" href="#quality-based-trimming" title="Permanent link">&para;</a></h3>
<p>Base call quality scores can be used to dynamically determine the trim
points for each read. A quality score threshold and minimum read length
following trimming can be used to remove low quality data.</p>
<p>The previous FastQC results show R1 is fine but R2 has low quality at
the end. There is no adaptor contamination though. We will be using
Skewer to perform the quality trimming.</p>
<p>Run the following command to quality trim a set of paired end data.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">cd</span> ~/qc
skewer -t <span class="m">20</span> -l <span class="m">50</span>  -q <span class="m">30</span> -Q <span class="m">25</span> -m pe qcdemo_R1.fastq.gz qcdemo_R2.fastq.gz
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>-t :   number of threads to use

-l :   min length to keep after trimming

-q :   Quality threshold used for trimming at 3’ end

-Q :   mean quality threshold for a read

-m :   pair-end mode
</pre></div>
</td></tr></table>

<p>Run FastQC on the quality trimmed file and visualise the quality scores.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>fastqc -f fastq qcdemo_R1.fastq-trimmed-pair1.fastq
fastqc -f fastq qcdemo_R1.fastq-trimmed-pair2.fastq
firefox qcdemo_R1.fastq-trimmed-pair1_fastqc.html &amp;
firefox qcdemo_R1.fastq-trimmed-pair2_fastqc.html&amp;
</pre></div>
</td></tr></table>

<p>Let’s look at the quality from the second reads. The output should look
like:</p>
<p><strong>FastQC Basic Statistics table</strong></p>
<table>
<thead>
<tr>
<th>Filename</th>
<th>qcdemo_R1.fastq-trimmed-pair2.fastq</th>
</tr>
</thead>
<tbody>
<tr>
<td>File type</td>
<td>Conventional base calls</td>
</tr>
<tr>
<td>Encoding</td>
<td>Sanger / Illumina 1.9</td>
</tr>
<tr>
<td>Total Sequences</td>
<td>742262</td>
</tr>
<tr>
<td>Filtered Sequences</td>
<td>0</td>
</tr>
<tr>
<td>Sequence length</td>
<td>50</td>
</tr>
<tr>
<td>%GC</td>
<td>37</td>
</tr>
</tbody>
</table>
<p><strong>Per base sequence quality plot for the quality-trimmed</strong>
<code class="codehilite">qcdemo_R2.fastq.gz</code></p>
<p><img alt="" src="../images/bad_qcdemo_R2_quality_trimmed.png" /></p>
<p><img alt="Question" src="../images/questions.png" /></p>
<ol>
<li>Did the number of total reads in R1 and R2 change after trimming?</li>
</ol>
<blockquote>
<p>Quality trimming discarded &gt;1000 reads. However, We retain a lot of maximal length reads which have good quality all the way to the ends.</p>
</blockquote>
<ol>
<li>What reads lengths were obtained after quality based trimming?</li>
</ol>
<blockquote>
<p>50-150 Reads &lt;50 bp, following quality trimming, were discarded.</p>
</blockquote>
<ol>
<li>Did you observe adapter sequences in the data?</li>
</ol>
<blockquote>
<p>No. (Hint: look at the overrepresented sequences.</p>
</blockquote>
<ol>
<li>How can you use -a option with fastqc ? (Hint: try fastqc -h).</li>
</ol>
<blockquote>
<p>Adaptors can be supplied in a file for screening.</p>
</blockquote>
<h3 id="adapter-clipping">Adapter Clipping<a class="headerlink" href="#adapter-clipping" title="Permanent link">&para;</a></h3>
<p>Sometimes sequence reads may end up getting the leftover of adapters and
primers used in the sequencing process. It’s good practice to screen
your data for these possible contamination for more sensitive alignment
and assembly based analysis.</p>
<p>This is particularly important when read lengths can be longer than the
molecules being sequenced. For example when sequencing miRNAs.</p>
<p>Various QC tools are available to screen and/or clip these
adapter/primer sequences from your data. Apart from skewer which will be
using today the following two tools are also useful for trimming and
removing adapter sequence.</p>
<p>Cutadapt: (<a href="http://code.google.com/p/cutadapt/">http://code.google.com/p/cutadapt/</a>)
Trimmomatic:
(<a href="http://www.usadellab.org/cms/?page=trimmomatic">http://www.usadellab.org/cms/?page=trimmomatic</a>)</p>
<p>Here we are demonstrating <code class="codehilite">Skewer</code> to trim a given adapter sequence.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>cd ~/qc
fastqc -f fastq  adaptorQC.fastq.gz
skewer -x TGGAATTCTCGGGTGCCAAGGT -t 20 -l 10 -L 35 -q 30 adaptorQC.fastq.gz
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>-x :   adaptor sequence used

-t :   number of threads to use

-l :   min length to keep after trimming

-L :   Max length to keep after trimming, in this experiment we were
    expecting only small RNA fragments

-Q :   Quality threshold used for trimming at 3’ end. Use -m option to
    control the end you want to trim
</pre></div>
</td></tr></table>

<p>Run FastQC on the adapter trimmed file and visualise the quality scores.
Fastqc now shows adaptor free results.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>fastqc -f fastq adaptorQC.fastq-trimmed.fastq
firefox adaptorQC.fastq-trimmed_fastqc.html &amp;
</pre></div>
</td></tr></table>

<p>An alternative tool, not installed on this system, for adapter clipping
is <code class="codehilite">fastq-mcf</code>. A list of adapters is provided in a text file. For more
information, see FastqMcf at
<a href="http://code.google.com/p/ea-utils/wiki/FastqMcf">http://code.google.com/p/ea-utils/wiki/FastqMcf</a>.</p>
<h3 id="fixed-length-trimming">Fixed Length Trimming<a class="headerlink" href="#fixed-length-trimming" title="Permanent link">&para;</a></h3>
<p><strong>We will not cover Fixed Length Trimming but provide the following for your information.</strong> Low quality read ends can be trimmed using a
fixed-length trimming. We will use the <code class="codehilite">fastx_trimmer</code> from the
FASTX-Toolkit. Usage message to find out various options you can use
with this tool. Type <code class="codehilite">fastx_trimmer -h</code> at anytime to display help.</p>
<p>We will now do fixed-length trimming of the <code class="codehilite">bad_example.fastq</code> file
using the following command. You should still be in the qc directory, if
not cd back in.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>cd ~/qc
fastqc -f fastq bad_example.fastq
fastx_trimmer -h
fastx_trimmer -Q 33 -f 1 -l 80 -i bad_example.fastq -o bad_example_trimmed01.fastq
</pre></div>
</td></tr></table>

<p>We used the following options in the command above:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>-Q 33 :   Indicates the input quality scores are Phred+33 encoded

-f :   First base to be retained in the output

-l :   Last base to be retained in the output

-i :   Input FASTQ file name

-o :   Output file name
</pre></div>
</td></tr></table></p>
<p>Run FastQC on the trimmed file and visualise the quality scores of the
trimmed file.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>fastqc -f fastq bad_example_trimmed01.fastq
firefox bad_example_trimmed01_fastqc.html &amp;
</pre></div>
</td></tr></table>

<p>The output should look like:</p>
<table>
<thead>
<tr>
<th>Filename</th>
<th>bad_example_trimmed01.fastq</th>
</tr>
</thead>
<tbody>
<tr>
<td>File type</td>
<td>Conventional base call</td>
</tr>
<tr>
<td>Encoding</td>
<td>Sanger / Illumina 1.9</td>
</tr>
<tr>
<td>Total Sequences</td>
<td>40000</td>
</tr>
<tr>
<td>Filtered Sequences</td>
<td>0</td>
</tr>
<tr>
<td>Sequence length</td>
<td>80</td>
</tr>
<tr>
<td>%GC</td>
<td>48</td>
</tr>
</tbody>
</table>
<p>: FastQC Basic Statistics table</p>
<p>
<script type="math/tex; mode=display">tab:badexampletrimmed</script>
</p>
<p>![Per base sequence quality plot for the fixed-length trimmed
<code class="codehilite">bad_example.fastq</code>
<img alt="Per base sequence quality plot for the fixed-length trimmed" src="../images/bad_example_trimmed_to_80bp.png" /></p>
<p>What values would you use for <code class="codehilite">-f</code> if you wanted to trim off 10 bases at
the 5’ end of the reads?</p>
<p><code class="codehilite">-f 11</code></p>
<h3 id="removing-duplicates">Removing Duplicates<a class="headerlink" href="#removing-duplicates" title="Permanent link">&para;</a></h3>
<p>Duplicate reads are the ones having the same start and end coordinates.
This may be the result of technical duplication (too many PCR cycles),
or over-sequencing (very high fold coverage). It is very important to
put the duplication level in context of your experiment. For example,
duplication level in targeted or re-sequencing projects may mean
something different in RNA-seq experiments. In RNA-seq experiments
oversequencing is usually necessary when detecting low abundance
transcripts.</p>
<p>The duplication level computed by FastQC is based on sequence identity
at the end of reads. Another tool, Picard, determines duplicates based
on identical start and end positions in SAM/BAM alignment files.</p>
<p><strong>We will not cover Picard but provide the following for your
information.</strong></p>
<p>Picard is a suite of tools for performing many common tasks with SAM/BAM
format files. For more information see the Picard website and
information about the various command-line tools available:</p>
<p><a href="http://picard.sourceforge.net/command-line-overview.shtml">http://picard.sourceforge.net/command-line-overview.shtml</a></p>
<p>A good list of tools for filtering PCR duplication can also be found at
<a href="http://omictools.com/duplicate-reads-removal-c495-p1.html">http://omictools.com/duplicate-reads-removal-c495-p1.html</a></p>
<p>Picard is installed on this system in <code class="codehilite">/usr/share/java</code></p>
<p>One of the Picard tools (MarkDuplicates) can be used to analyse and
remove duplicates from the raw sequence data. The input for Picard is a
sorted alignment file in BAM format. Short read aligners such as,
bowtie, BWA and tophat can be used to align FASTQ files against a
reference genome to generate SAM/BAM alignment format.</p>
<p>Interested users can use the following general command to run the
MarkDuplicates tool at their leisure. You only need to provide a BAM
file for the INPUT argument (not provided):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>cd ~/qc
java -jar /usr/share/java/MarkDuplicates.jar INPUT=&lt;alignment_file.bam&gt; VALIDATION_STRINGENCY=LENIENT OUTPUT=alignment_file.dup METRICS_FILE=alignment_file.matric ASSUME_SORTED=true REMOVE_DUPLICATES=true
</pre></div>
</td></tr></table>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../denovo-module-scaffolding/scaffold/" title="Scaffolding" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Scaffolding
              </span>
            </div>
          </a>
        
        
          <a href="../../metagenomics-module-tax/tax/" title="Metagenomics Taxonomic" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Metagenomics Taxonomic
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; The authors; 2017-
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application-e3caa82af6.js"></script>
      
      
      <script>app.initialize({url:{base:"../../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../../../js/details.js"></script>
      
    
    
      
    
  </body>
</html>